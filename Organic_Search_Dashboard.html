<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['corechart', 'controls', 'table']});
      google.charts.setOnLoadCallback(initialize);
	  
	  function initialize() {
        var opts = {sendMethod: 'auto'};
        // Replace the data source URL on next line with your data source URL.
        var query = new google.visualization.Query('https://docs.google.com/spreadsheets/d/1bqRWtvB6kxBfeIuVzCwVXZ5_mCn1b542CaIwE116jK8/edit#gid=0', opts);  
        query.setQuery("Select *");		
        // Send the query with a callback function.
        query.send(handleQueryResponse);
     }
	 
	 function handleQueryResponse(response) {
      if (response.isError()){
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;		
		}
	   var data = response.getDataTable();
      
       var dashboard = new google.visualization.Dashboard(
          document.getElementById('programmatic_dashboard_div'));

        // We omit "var" so that programmaticSlider is visible to changeRange.
        programmaticSlider = new google.visualization.ControlWrapper({
          'controlType': 'CategoryFilter',
          'containerId': 'programmatic_control_div',
          'options': {
            'filterColumnIndex': '0',
            'ui': {'labelStacking': 'vertical'}
          }
        });
		
		// error here. states columnIndex or columnLabel must be specified
		programmaticDateRange = new google.visualization.ControlWrapper({
			'controlType': 'ChartRangeFilter',
			'containerId': 'programmatic_slider_div',
			'options': {'filterColumnIndex': 0,
			'ui': {'chartType':'LineChart', 'snapToData': 'false', 'chartView':{'columns':[0,1,2,3,4,5,6,7]}}
		  }
		});

       var programmaticChart  = new google.visualization.ChartWrapper({
        'chartType': 'LineChart',
        'containerId': 'programmatic_chart_div',
        'options': {
          'width': 750,
          'height': 300,
          'legend': {position: 'top', textStyle: {color: 'blue', fontSize: 16}},
          'chartArea': {'left': 30, 'top': 30, 'right': 0, 'bottom': 30},
		  'title': 'Popular Queries for March',
		  'axes': {
          'x': {
            0: {'side': 'bottom'}
          }
		  },
		  'vAxis': { 'title': 'Clicks'},
		  'hAxis': { 'title': 'Day',   
		             'titleTextStyle': 
					 {
                        'color': 'grey'
                     }
                   }
        }
      });
	    
		var table_results = new google.visualization.ChartWrapper({
		'chartType': 'Table',
		'containerId' : 'table_div',
		'chartArea' : {'left': 30, 'top': 30, 'right': 0, 'bottom': 0}
		});
		
		var programmaticPieChart = new google.visualization.ChartWrapper({
		'chartType': 'PieChart',
		'containerId': 'pie_chart',
		'options': {'title': 'Queries'},
		'view': {'columns': [0,1,2,3,4,5,6,7]}
		});
	   
	  dashboard.bind([programmaticDateRange], [programmaticChart, programmaticPieChart, table_results]);
      dashboard.draw(data);
    }

    </script>
  </head>
  <body>
    <div id="programmatic_dashboard_div" style="border: 10px">
      <table class="columns">
        <tr>
          <td>
            <div id="programmatic_chart_div" style="width: 800px; height: 300px"></div>
			<div id="programmatic_slider_div" style="height: 50px"></div>
          </td>
		            <td>
            <div id="programmatic_control_div" style="padding-left: 2em; min-width: 250px"></div>
            <div>
            </div>
            <script type="text/javascript">
              function changeRange() {
                programmaticSlider.setState({'lowValue': 2, 'highValue': 5});
                programmaticSlider.draw();
              }
            </script>
		  </td>
        </tr>
		<tr>
		<td>
		<div id="table_div" style="width: 800px; height: 700px; padding-left: 50;"></div>
		</td>
		<td>
		<div id="pie_chart" style="width: 275px; height: 300px"></div>
		</td>
		</tr>
      </table>
    </div>
  </body>
</html>